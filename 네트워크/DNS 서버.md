# DNS(Domain Name System) 서버

DNS 서버는 도메인 이름을 IP 주소로 변환하거나, 그 반대의 역할을 하는 서버입니다.

## 서버 종류
- Root DNS Server
- TLD DNS Server
- Authoritative DNS Server
- Recursive DNS Server

## 동작 과정

### DNS에 도메인 주소에 해당하는 IP 주소를 얻어오는 과정
1. 먼저 컴퓨터의 브라우저 캐시와 호스트 파일에 도메인 주소에 해당하는 IP 주소가 없을 경우 DNS에 도메인 주소에 해당하는 IP주소를 요청합니다.
2. Local DNS 서버에서 먼저 캐시를 확인합니다. 캐시에 존재하면 바로 반환하지만 그렇지 않으면
   Root DNS 서버로 요청을 보냅니다. Root DNS 서버의 응답으로 Top Level DNS 서버(.com) 주소를 얻습니다.
   그 후 Local DNS서버에서 Top Level DNS 서버에 요청을 보냅니다. 그러면 Sub Level DNS(naver.com) 서버 주소를 응답 받습니다.
   그 후 Local DNS서버에서 Sub Level DNS(naver.com) 서버에 요청을 보내서 IP 주소를 얻어옵니다. 
3. 얻어온 IP를 Local DNS 서버 캐시에 저장하고 요청을 보낸 브라우저에 응답으로 보냅니다.
4. 브라우저는 먼저 PC에 설정된 로컬 DNS 서버에 해당 도메인과 호스트명의 IP를 가지고 있는지 찾습니다.
5. 로컬 DNS에 있다면 반환을 하고 없다면 Root DNS 서버에 물어봅니다.
6. 그러면 .com, .org 등에 따라 .com 담당 서버로 가서 [naver.com](http://naver.com) 정보를 가진 DNS 서버의 IP 를 반환합니다.
7. 그러면 이 서버에 호스트네임별 IP 주소가 있어 그걸 보고 www에 해당하는 웹서버 IP 주소를 얻어내 브라우저에 반환합니다.



### DNS 서비스에 부하가 걸린다고 한다면? 해결방안?
DNS
  라운드로빈 DNS는 여러 대의 서버로 구성된 웹 사이트나 서비스에 대한 트래픽을 분산하는 방법 중 하나입니다. 

1. 여러 서버가 동일한 웹 콘텐츠를 호스팅하거나 동일한 기능을 수행할 수 있도록 합니다.
2. DNS 서버에서는 해당 도메인 이름에 대한 IP 주소를 조회할 때, 여러 대의 서버 IP 주소를 라운드로빈 방식으로 반환합니다.
3. 클라이언트(웹 브라우저 등)가 도메인 이름에 대한 IP 주소를 받으면, 이 중에서 하나의 IP 주소를 선택하여 해당 서버에 접속합니다.
4. 다음 클라이언트의 요청은 다음 순서의 IP 주소로 접속하며, 이를 반복합니다. 이로써 트래픽은 여러 서버 사이에 균등하게 분산됩니다.

  라운드로빈 DNS는 간단한 분산 로드 밸런싱 기술로, 서버의 부하를 분산시키고 성능을 향상시킬 수 있습니다. 클라이언트 요청을 여러 서버에 균등하게 분배하여 효율적인 자원 활용과 가용성을 제공합니다.


### DNS 서버가 UDP를 사용하는 이유?
- 신뢰성 보다는 속도에 중점을 두고 있어서 그렇다. DNS 서버에 요청을 할 때마다 핸드쉐이킹을 한다고 하면 시간이 지연될 것이다.
- TCP는 end point에서 연결 상태를 유지하지만 UDP에서는 정보를 기록하고 유지할 필요가 없다.

  AWS에서 제공하는 DNS로는 router53이 있다. 여기서는 어떤 로드밸런싱 전략을 사용할 것인지 정할 수 있다. (라운드 로빈, 가중치 기반 로드밸런싱, 지연 기반 로드밸런싱, 체인지 프락시 로드밸런싱 (CPLB), 단순 회전 및 랜덤 선택)


#### 레코드
- CNAME과 A Record
  - A Record는 도메인 이름에 IP를 매핑합니다.
  - CNAME은 도메인 이름과 도메인 이름을 한번 더 매핑합니다. 예를 들어 AWS에서 서버 인스턴스를 생성하면 도메인 이름을 넘겨주는데 , IP 주소가 변경되어도 사용자가 사용하는 도메인 이름을 변경하지 않아도 돼서 그런 것
  - CNAME은 도메인 이름에 대한 매핑을 중간에 추가함으로써, 서버 인스턴스의 IP 주소 변경에 유연하게 대처할 수 있는 방법을 제공합니다. 이를 통해 사용자는 기존의 도메인 이름을 계속 사용하면서 서버에 접속할 수 있습니다.
